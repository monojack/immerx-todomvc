{"version":3,"sources":["webpack:///../devtools/esm/index.js","webpack:///./src/common/isEnterKey.js","webpack:///./src/components/Header.js","webpack:///./src/components/Todo.js","webpack:///./src/common/isEscapeKey.js","webpack:///./src/constants/index.js","webpack:///./src/hooks/useHash.js","webpack:///./src/components/ListFooter.js","webpack:///./src/components/TodoList.js","webpack:///./src/components/Footer.js","webpack:///./src/components/App.js","webpack:///./src/index.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","checkForHook","_window","hook","__IMMERX_DEVTOOLS_HOOK__","enabled","createDevToolsMiddleware","options","_state$","defaultOptions","opts","state$","console","error","_hook","window","init","value","emit","buffer","_ref","state","patches","ignoreEmptyPatches","push","e","isEnterKey","keyCode","which","Header","update","useImmerx","useState","setValue","className","placeholder","onChange","onKeyUp","draft","_id","uuid","label","completed","Todo","id","lens","useMemo","get","t","set","idx","childState","todo","editable","setEditable","inputRef","useRef","useEffect","data-id","type","checked","onDoubleClick","onClick","ref","onBlur","isEscapeKey","HASHES","getHash","w","hash$","listeners","subscribe","unsubscribe","next","listener","useHash","hash","setHash","sub","ListFooter","remaining","onClearCompleted","href","filters","TodoList","todos","produce","visibleTodos","htmlFor","Footer","App","devToolsMiddleware","create","render","document"],"mappings":"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","file":"app.292b3da44006a804dbd0.js","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction checkForHook(_window) {\n  var hook = _window.__IMMERX_DEVTOOLS_HOOK__;\n  hook && (hook.enabled = true);\n  return hook;\n}\n\nexport function createDevToolsMiddleware(options) {\n  var defaultOptions = {};\n  var opts = options !== null && typeof options === 'object' ? _extends({}, defaultOptions, options) : defaultOptions;\n\n  var _state$;\n\n  var middleware = state$ => {\n    if (_state$) {\n      if (process.env.NODE_ENV !== 'production') {\n        throw new Error(\"The middleware is already initialized\");\n      } else {\n        console.error(\"The middleware is already initialized\");\n      }\n    }\n\n    var _hook = checkForHook(window);\n\n    _state$ = state$;\n    var init = state$.value;\n    _hook && _hook.emit([init]);\n    var buffer = [init];\n    return (_ref, state) => {\n      var {\n        patches\n      } = _ref;\n      if (!!opts.ignoreEmptyPatches && patches.length === 0) return;\n      buffer.push([state, {\n        patches\n      }]);\n\n      if (!_hook) {\n        _hook = checkForHook(window);\n\n        if (_hook) {\n          for (var e of buffer) {\n            _hook.emit(...e);\n          }\n        }\n      } else {\n        _hook.emit([state, {\n          patches\n        }]);\n      }\n    };\n  };\n\n  return middleware;\n}\nexport default createDevToolsMiddleware;\n","export function isEnterKey({ key, keyCode, which }) {\n  return key === 'Enter' || keyCode === 13 || which === 13\n}\n","import React, { useState } from 'react'\nimport { useImmerx } from '@immerx/react'\nimport { v4 as uuid } from 'uuid'\nimport { isEnterKey } from '../common/isEnterKey'\n\nexport function Header() {\n  const [, update] = useImmerx()\n  const [value, setValue] = useState('')\n\n  function onSubmit() {\n    update(\n      draft =>\n        void draft.todos.push({\n          _id: uuid(),\n          label: value,\n          completed: false,\n        }),\n    )\n    setValue('')\n  }\n\n  return (\n    <header className=\"header\">\n      <h1>Todos</h1>\n      <input\n        className=\"new-todo\"\n        placeholder=\"What needs to be done?\"\n        value={value}\n        onChange={({ target: { value } }) => setValue(value)}\n        onKeyUp={e => isEnterKey(e) && onSubmit()}\n      />\n    </header>\n  )\n}\n","import React, { useState, useRef, useEffect, useMemo } from 'react'\nimport { useImmerx } from '@immerx/react'\nimport { isEnterKey } from '../common/isEnterKey'\nimport { isEscapeKey } from '../common/isEscapeKey'\n\nexport function Todo({ id }) {\n  const lens = useMemo(\n    () => ({\n      get: state => state.todos.find(t => t._id === id),\n      set: (state, childState) => {\n        const idx = state.todos.findIndex(t => t._id === id)\n\n        if (childState === null) {\n          state.todos.splice(idx, 1)\n        } else {\n          Object.assign(state.todos[idx], childState)\n        }\n      },\n    }),\n    [id],\n  )\n\n  const [todo, update] = useImmerx(lens)\n  const [editable, setEditable] = useState(false)\n  const [value, setValue] = useState(todo.label)\n  const inputRef = useRef(null)\n\n  const onToggle = () =>\n    update(draft => void (draft.completed = !draft.completed))\n  const onChange = ({ target: { value } }) => setValue(value)\n  const onSubmit = () => update(draft => void (draft.label = value))\n  const onRemove = () => update(draft => null)\n  const onKeyUp = e => {\n    if (isEnterKey(e)) {\n      setEditable(false)\n      onSubmit()\n    } else if (isEscapeKey(e)) {\n      setEditable(false)\n      setValue(todo.label)\n    }\n  }\n\n  useEffect(() => {\n    if (editable) {\n      inputRef.current?.select()\n    }\n  }, [editable])\n\n  return (\n    <li\n      data-id={todo._id}\n      className={[\n        todo.completed ? 'completed' : '',\n        editable ? 'editing' : '',\n      ].join(' ')}\n    >\n      <div className=\"view\">\n        <input\n          className=\"toggle\"\n          type=\"checkbox\"\n          onChange={onToggle}\n          checked={todo.completed}\n        />\n        <label onDoubleClick={() => setEditable(true)}>{todo.label}</label>\n        <button className=\"destroy\" onClick={onRemove} />\n      </div>\n      <input\n        ref={inputRef}\n        className=\"edit\"\n        onBlur={() => setEditable(false)}\n        onChange={onChange}\n        onKeyUp={onKeyUp}\n        value={value}\n      />\n    </li>\n  )\n}\n","export function isEscapeKey({ key, keyCode, which }) {\n  return key === 'Escape' || keyCode === 27 || which === 27\n}\n","export const HASHES = {\n  ALL: '',\n  ACTIVE: 'active',\n  COMPLETED: 'completed',\n}\n","import { useState, useEffect } from 'react'\n\nfunction getHash(w) {\n  return w.location.hash.replace(/^#\\//, '')\n}\n\nconst hash$ = {\n  listeners: new Set(),\n  value: getHash(window),\n  subscribe(listener) {\n    this.listeners.add(listener)\n\n    return { unsubscribe: () => this.listeners.delete(listener) }\n  },\n  next(hash) {\n    for (const listener of this.listeners) listener(hash)\n    this.value = hash\n  },\n}\n\nwindow.addEventListener('hashchange', onHashChange)\nfunction onHashChange(e) {\n  hash$.next(getHash(e.target))\n}\n\nexport function useHash() {\n  const [hash, setHash] = useState(getHash(window))\n\n  useEffect(() => {\n    const sub = hash$.subscribe(setHash)\n    return () => sub.unsubscribe()\n  }, [])\n\n  return hash\n}\n","import React from 'react'\n\nimport { HASHES } from '../constants'\nimport { useHash } from '../hooks/useHash'\n\nexport function ListFooter({ remaining, completed, onClearCompleted }) {\n  const hash = useHash()\n\n  return (\n    <footer className=\"footer\">\n      <span className=\"todo-count\">\n        <strong>{remaining}</strong>\n        {` item${~(remaining - 2) ? 's' : ''} left`}\n      </span>\n      <ul className=\"filters\">\n        <li>\n          <a className={hash === HASHES.ALL ? 'selected' : ''} href=\"#/\">\n            All\n          </a>\n        </li>\n        <li>\n          <a\n            className={hash === HASHES.ACTIVE ? 'selected' : ''}\n            href=\"#/active\"\n          >\n            Active\n          </a>\n        </li>\n        <li>\n          <a\n            className={hash === HASHES.COMPLETED ? 'selected' : ''}\n            href=\"#/completed\"\n          >\n            Completed\n          </a>\n        </li>\n      </ul>\n      {!!completed && (\n        <button className=\"clear-completed\" onClick={onClearCompleted}>\n          Clear completed\n        </button>\n      )}\n    </footer>\n  )\n}\n","import React, { useMemo } from 'react'\nimport { useImmerx } from '@immerx/react'\n\nimport { Todo } from './Todo'\nimport { ListFooter } from './ListFooter'\n\nimport { HASHES } from '../constants'\nimport { useHash } from '../hooks/useHash'\n\nconst filters = {\n  [HASHES.ALL]: t => true,\n  [HASHES.ACTIVE]: t => !t.completed,\n  [HASHES.COMPLETED]: t => t.completed,\n}\n\nexport function TodoList() {\n  const [todos, produce] = useImmerx('todos')\n  const hash = useHash()\n\n  const visibleTodos = useMemo(() => todos.filter(filters[hash]), [hash, todos])\n  const remaining = useMemo(() => visibleTodos.filter(t => !t.completed), [\n    visibleTodos,\n  ])\n  const completed = useMemo(() => visibleTodos.filter(t => t.completed), [\n    visibleTodos,\n  ])\n\n  function onToggleAll() {\n    produce(draft =>\n      draft.forEach(todo => (todo.completed = !!remaining.length)),\n    )\n  }\n\n  function onClearCompleted() {\n    // // // state replace\n    // produce(draft => draft.filter(t => !t.completed))\n    // // individual updates\n    // let count = 0\n    // todos.forEach((todo, i) => {\n    //   todo.completed && produce(draft => void draft.splice(i - count++, 1))\n    // })\n    // reverse splice loop\n    produce(draft => {\n      let i = draft.length - 1\n      while (i >= 0) {\n        draft[i].completed && draft.splice(i, 1)\n        i -= 1\n      }\n      // TODO: write an issue about replace/remove patches here\n    })\n  }\n\n  return todos.length ? (\n    <>\n      <main className=\"main\">\n        <input\n          id=\"toggle-all\"\n          className=\"toggle-all\"\n          type=\"checkbox\"\n          onChange={onToggleAll}\n          checked={!remaining.length}\n        />\n        <label htmlFor=\"toggle-all\">Mark all as complete</label>\n        <ul className=\"todo-list\">\n          {visibleTodos.map(todo => (\n            <Todo {...{ id: todo._id }} key={todo._id} />\n          ))}\n        </ul>\n      </main>\n      <ListFooter\n        completed={completed.length}\n        remaining={remaining.length}\n        onClearCompleted={onClearCompleted}\n      />\n    </>\n  ) : null\n}\n","import React from 'react'\n\nexport function Footer() {\n  return (\n    <footer className=\"info\">\n      <p>Double-click to edit a todo</p>\n      <p>\n        Created by <a href=\"https://github.com/monojack\">Ionut Achim</a>\n      </p>\n      <p>\n        Part of <a href=\"http://todomvc.com\">TodoMVC</a>\n      </p>\n    </footer>\n  )\n}\n","import React from 'react'\nimport 'todomvc-common/base.css'\nimport 'todomvc-app-css/index.css'\n\nimport { Header } from './Header'\nimport { TodoList } from './TodoList'\nimport { Footer } from './Footer'\n\nexport function App() {\n  return (\n    <>\n      <section className=\"todoapp\" key={'app-section'}>\n        <Header />\n        <TodoList />\n      </section>\n      <Footer />\n    </>\n  )\n}\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { create } from '@immerx/react'\nimport { createDevToolsMiddleware } from '@immerx/devtools'\n\nimport { App } from './components/App'\n\nconst devToolsMiddleware = createDevToolsMiddleware()\ncreate(\n  {\n    todos: [\n      {\n        _id: '4ecca858-67f8-491e-94cc-48b262061819',\n        label: 'Taste JavaScript',\n        completed: true,\n      },\n      {\n        _id: '3c4a086e-2151-4b54-acb2-13044ea553c1',\n        label: 'Buy a unicorn',\n        completed: false,\n      },\n    ],\n  },\n  [devToolsMiddleware],\n)\n\nrender(<App />, document.getElementById('root'))\n"],"sourceRoot":""}